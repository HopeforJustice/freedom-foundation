"use client";

import { useState, useEffect } from "react";
import { useSearchParams } from "next/navigation";
import { useSelection } from "../context/SelectionContext";
import { redirect } from "next/navigation";
import Image from "next/image";
import Link from "next/link";
import Container from "../components/Container";
import FreedomFoundationBanner from "../components/FreedomFoundationBanner";
import ProjectHero from "../components/ProjectHero";
import Highlight from "../components/Highlight";
import ProjectIntro from "../components/ProjectIntro";
import ProjectStory from "../components/ProjectStory";
import ProjectOutcomes from "../components/ProjectOutcomes";
import CTABanner from "../components/CTABanner";
import BoxQuote from "../components/BoxQuote";
import GivingDetails from "../components/GivingDetails";

export default function Page() {
	const { selection, setSelection } = useSelection();
	const [loading, setLoading] = useState(true);
	const searchParams = useSearchParams();

	useEffect(() => {
		const name = searchParams.get("name");
		const type = searchParams.get("type");

		if (type && name) {
			setSelection({ name, type });
		}
		setLoading(false);
	}, [searchParams, setSelection]);

	if (loading) {
		return null;
	}

	if (!selection.name) {
		redirect("/");
	}

	const project = {
		image: "/childreninAddis.jpg",
		title: "safe shelter and care for exploited children in Ethiopia",
		altText: "Happy Children in Addis",
		budget: "£244,044",
		budgetNumber: 244044,
		id: "PP1028 Deborah",
		intro: {
			title: "Together, we can make a life-changing impact",
			text: [
				"A Lighthouse in the darkness. Hope for Justice’s Lighthouse shelters in Ethiopia offer a place of safety and healing for child survivors of trafficking and those most vulnerable to being targeted. Our Lighthouse for girls offers critical services such as healthcare, catch-up education, psychosocial support and life skills. Our model is family-first, prioritising reintegration into safe families and communities, and avoiding institutionalisation.",
				"With your help, we can serve more exploited and at-risk children who desperately need safety, care and shelter.",
			],
		},
		projectOutcomes: [
			"200 children ages 7-17 served in the Lighthouse in 12 months",
			"Every child to be reintegrated from the Lighthouse to a safe family setting as soon as possible, or (where appropriate and in their interests) helped to live safely and independently in the community with sustainable employment. Every child to receive follow-up visits from our team.",
			"Every child taught how best to keep safe against the risk of further exploitation and abuse.",
			"Every child has improved wellbeing (physical, emotional, psychosocial and spiritual).",
			"Every child is helped to return to education at an appropriate level if this is in their best interest. ",
			"Every child’s legal rights are protected, and they are helped to access legal support wherever possible.",
		],
		link: "/pre-donation",
	};

	if (selection.country === "US") {
		project.text = [
			"A Lighthouse in the darkness. Hope for Justice’s Lighthouse shelters in Ethiopia offer a place of safety and healing for child survivors of trafficking and those most vulnerable to being targeted. Our Lighthouse for girls offers critical services such as healthcare, catch-up education, psychosocial support and life skills. Our model is family-first, prioritizing reintegration into safe families and communities, and avoiding institutionalization.",
			"With your help, we can serve more exploited and at-risk children who desperately need safety, care and shelter.",
		];
		project.budget = "$244,044";
		project.budgetNumber = 244044;
	}
	return (
		// page wrapper
		<div className="animate-fade-in">
			<ProjectHero
				donorName={selection.name}
				donorType={selection.type}
				image={project.image}
				altText={project.altText}
				title={project.title}
				link={project.link}
				projectId={project.id}
				budgetNumber={project.budgetNumber}
			/>
			<ProjectIntro title={project.intro.title} text={project.intro.text} />
			<FreedomFoundationBanner />
			<ProjectStory
				title="You will help people like Candace*"
				quote=""
				image="/ethiopia-candace.jpg"
				imagePosition="left"
				imageAlt="Image used for illustration purposes."
				imageCredit="Image used for illustration purposes."
				titleTop={true}
			>
				Candace was born in southern Ethiopia and after her parents separated,
				she lived with her grandparents, who was desperately poor. To support
				her family and continue her education, Candace decided to travel to the
				capital city, Addis Ababa. She found work as a domestic worker for a
				police officer who promised to send her to school. At first, her working
				conditions were good, and she was hopeful.
				<br></br>
				<br></br>
				However, things took a dark turn when the police officer abused his
				power over her. It started with verbal harassment and quickly escalated.
				When she was just 14 years old, he forced Candace to consume a toxic
				substance and raped her. She was trapped in this abusive situation and
				coerced into silence. The cycle of abuse ended when the police
				officer&apos;s wife discovered what was happening and reported it. The
				police got her out of the house and brought her to Hope for Justice. She
				stayed at one of our Lighthouses, temporary safe havens for children who
				have been exploited or are at risk of exploitation. There, she received
				care, support, and trauma-informed therapy, which helped her recover and
				rebuild her life. Eventually, it was safe for her to return to her
				family. She bravely testified against her abuser in an Ethiopian federal
				court, leading to his conviction and a six-year prison sentence. She is
				now focused on her future and determined to achieve her dreams. Candace
				wants to continue her education and hopes to run a small business
				selling fruit in her community.
			</ProjectStory>
			<ProjectOutcomes
				outcomes={project.projectOutcomes}
				budget={project.budget}
			/>
			<CTABanner
				title="Make a life-changing impact today!"
				color="red"
				link={project.link}
				buttonText="Take the next step"
				projectId={project.id}
				budgetNumber={project.budgetNumber}
				projectTitle={project.title}
			/>
			<BoxQuote
				image="/global-fund.svg"
				imageAlt="Independent case study commissioned by the Global Fund to End Modern Slavery"
				quote="“[The Lighthouse teams are] highly engaged, knowledgeable … and … dedicated to incorporating trauma-informed care into their everyday work with survivors of human trafficking and exploitation.”"
				author="Independent case study commissioned by the Global Fund to End Modern Slavery"
			/>
			<GivingDetails budget={project.budget} projectTitle={project.title} />
			<CTABanner
				title="Make a life-changing impact today!"
				color="white"
				link={project.link}
				buttonText="Take the next step"
				projectId={project.id}
				budgetNumber={project.budgetNumber}
				projectTitle={project.title}
			/>
			<p className="text-sm my-4 w-full px-4 text-center">
				*Names and images changed to protect identities
			</p>
			<div className="h-20"></div>
		</div>
	);
}
